<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ICRmax &mdash; ICRMax 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ICRMax 1.0 documentation" href="#" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="#">ICRMax 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="icrmax">
<h1>ICRmax<a class="headerlink" href="#icrmax" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="what-is-icrmax">
<h1>What is ICRmax?<a class="headerlink" href="#what-is-icrmax" title="Permalink to this headline">¶</a></h1>
<p>ICRmax is a computational pipeline designed for the cost-effective identification of a minimal set of tumor-specific interchromosomal rearrangements (ICRs) for clinical application.</p>
</div>
<div class="section" id="how-icrmax-works">
<h1>How ICRmax works<a class="headerlink" href="#how-icrmax-works" title="Permalink to this headline">¶</a></h1>
<p>ICRmax was developed with a set of strict filters to eliminate false positive ICR events. The pipeline is able to remove most cases of non-somatic events without the need for sequencing the matched normal genome for each sample.</p>
</div>
<div class="section" id="benefits">
<h1>Benefits<a class="headerlink" href="#benefits" title="Permalink to this headline">¶</a></h1>
<p>The cost reduction resulting from this approach creates an opportunity to implement this analysis in the clinical setting, mainly for detection of personalized biomarkers that can be used in the management of solid tumors.</p>
</div>
<div class="section" id="requirements">
<h1>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h1>
<p>All the steps necessary for the ICRmax pipeline can be performed using open-source software/pipelines and publicly available data.</p>
<p><strong>Software and pipelines:</strong></p>
<ul class="simple">
<li>A computer running Linux (suggested distributions: Ubuntu, Fedora or CentOS. ICRMax should work on all Linux distributions).</li>
<li>BLAT (how to install: <a class="reference external" href="http://users.soe.ucsc.edu/~kent/src/">http://users.soe.ucsc.edu/~kent/src/</a>)</li>
<li>Bedtools (how to install: <a class="reference external" href="http://bedtools.readthedocs.org/en/latest/">http://bedtools.readthedocs.org/en/latest/</a>)</li>
</ul>
<p><strong>Data:</strong></p>
<ul class="simple">
<li>Alternative genome assemblies (see Preparing the WGS reads).</li>
<li>Recurrent artifacts (download here <a class="reference external" href="http://www.bioinfo.mochsl.org.br/icrmax/recurrent_artifacts.bed">recurrent_artifacts.bed</a> or <a class="reference external" href="http://www.bioinfo.mochsl.org.br/icrmax/recurrent_1000G.bed">recurrent_1000G.bed</a>).</li>
<li>Repetitive regions to filter (download here <a class="reference external" href="http://www.bioinfo.mochsl.org.br/icrmax/centr_and_tel.bed">centr_and_tel.bed</a> and <a class="reference external" href="http://www.bioinfo.mochsl.org.br/icrmax/all_to_mask.bed">all_to_mask.bed</a>)</li>
<li>Whole genome sequence alignment data in BAM or BED format (see below for details).</li>
</ul>
<p>To transform paired bam files into bedpe use:</p>
<div class="highlight-python"><div class="highlight"><pre>$ bedtools bamtobed –bedpe &lt;input.bam&gt;
</pre></div>
</div>
<p>Example bedpe file:</p>
<a class="reference internal image-reference" href="_images/inputfile.png"><img alt="_images/inputfile.png" class="align-center" src="_images/inputfile.png" /></a>
</div>
<div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p>To run ICRmax simply follow the Step-by-step command line summarized in the figure below:</p>
<a class="reference internal image-reference" href="_images/Donnard_Fig1.png"><img alt="_images/Donnard_Fig1.png" class="align-center" src="_images/Donnard_Fig1.png" /></a>
</div>
<div class="section" id="preparing-the-wgs-reads">
<h1>Preparing the WGS reads<a class="headerlink" href="#preparing-the-wgs-reads" title="Permalink to this headline">¶</a></h1>
<p>Mate-pair or paired-end reads resulting from whole genome sequencing must be aligned to the reference genome. Users are free to choose the best mapping algorithm for their platform. Suggestions are NovoAlignCS and BioScope for SOLiD mate-pair reads and BWA or ... for Illumina paired-end reads.</p>
<p>Alignment to alternative reference assemblies is also advised since differences in assembly can give rise to mate-pair reads mapped in different chromosomes according to one assembly but not another. Some alternative assemblies that can be used for mapping are:</p>
<p><strong>HuRef</strong> (J. Craig Venter Institute) [Levy et. al 2007]</p>
<p><strong>GRCh37_alt</strong> (Partial reference genome with alternative representations – Genome Reference Consortium)</p>
<p><strong>CRA</strong> (Human chr7 complete sequence – The Center for Applied Genomics) [Scherer et al. 2003]</p>
<p>Note: For the alternative assemblies, use as input only the reads belonging to mate-pairs that mapped in different chromosomes in the initial reference genome alignment. There is no need to realign the reads that have already mapped to the same chromosome.</p>
</div>
<div class="section" id="step-by-step-command-line">
<h1>Step-by-step command line<a class="headerlink" href="#step-by-step-command-line" title="Permalink to this headline">¶</a></h1>
<p>At this step you should have a paired BED file (bedpe) containing the aligned mate-pair or paired-end reads mapped in different chromosomes with mapping quality greater than or equal to 20, after the reference genome mapping and mapping to alternative reference assemblies. The duplicate reads should also have been removed. For that, samtools rmdup is a good option (see <a class="reference external" href="http://www.htslib.org/man/samtools">http://www.htslib.org/man/samtools</a>)</p>
</div>
<div class="section" id="step-by-step-here-arq-suplementar-icrmax">
<h1>Step-by-step here (arq. Suplementar ICRmax)<a class="headerlink" href="#step-by-step-here-arq-suplementar-icrmax" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="initial-icrmax-output">
<h1>Initial ICRmax output<a class="headerlink" href="#initial-icrmax-output" title="Permalink to this headline">¶</a></h1>
<p>Example initial output:</p>
<ul class="simple">
<li>$1 == read1_chromosome</li>
<li>$2 == read1_start_position</li>
<li>$3 == read1_end_position</li>
<li>$4 == read2_chromosome</li>
<li>$5 == read2_start_position</li>
<li>$6 == read2_end_position</li>
<li>$7 == matepair_id</li>
<li>$8 == qual</li>
<li>$9 == read1_strand</li>
<li>$10 == read2_strand</li>
<li>$11 == cluster_id</li>
</ul>
<p>Cluster ids should have 3 numbers (eg: 14774_4005_1). Each cluster id groups reads mapping around one ICR breakpoint.</p>
</div>
<div class="section" id="removing-recurrent-events">
<h1>Removing recurrent events<a class="headerlink" href="#removing-recurrent-events" title="Permalink to this headline">¶</a></h1>
<p>The final clusters of mate-pair reads can be merged at this stage so that each event has two coordinates, one in each chromosome.</p>
<p>The command below will separate the read coordinates (one line for each chromosome) and with the simple perl script the overlapping reads will be joined into a single coordinate for each chromosome.</p>
<div class="highlight-python"><div class="highlight"><pre>$ awk &#39;{print $1&quot;\t&quot;$2&quot;\t&quot;$3&quot;\t&quot;$11&quot;\n&quot;$4&quot;\t&quot;$5&quot;\t&quot;$6&quot;\t&quot;$11}&#39; input_after_pipeline.bed &gt; reads_in_final_clusters.bed
$ perl input.pl reads_in_final_clusters.bed &gt; merged.bed
</pre></div>
</div>
<p>The merged.bed file can then be used to check for recurrent artifacts and remove them. With bedtools intersect you can compare both your file and the recurrent artifact list, and with the subsequent awk commands you select only the events with both chromosome positions equal to a single other event in the artifact list. The output contains only the ids for the events you should remove from your final list.</p>
<div class="highlight-python"><div class="highlight"><pre>$ bedtools intersect –wo –a merged.bed –b recurrent_artifacts.bed | awk ‘{print $1,$4,$8}’ | sort | uniq | awk ‘{print $2,$3}’ | sort | uniq –d | awk ‘{print $1}’ | sort | uniq &gt; recurrent_merged.bed
$ fgrep –w –v –f recurrent_merged.bed merged.bed &gt; merged_final.bed
</pre></div>
</div>
</div>
<div class="section" id="detecting-new-recurrent-events-in-your-samples">
<h1>Detecting new recurrent events in your samples<a class="headerlink" href="#detecting-new-recurrent-events-in-your-samples" title="Permalink to this headline">¶</a></h1>
<p>Comparison between rearrangements from different samples can be easily done with the bedtools merge command as used above, make sure to allow for a distance similar to the clustering distance used (-d 1000) outside of the read span and alter the cluster names to include sample identification (ex: 14774_4005_1_RT2). This way, after the bedtools merge command using the parameters –nms you should have a single cluster and the different cluster names separated by a semicolon.</p>
<div class="highlight-python"><div class="highlight"><pre>$ sortBed all_sample_rearrangements.bed | bedtools merge –d 1000 –nms &gt; merged_samples.bed
</pre></div>
</div>
<p>To process this file a simple perl script is used</p>
<div class="highlight-python"><div class="highlight"><pre>$ perl find_recurrent.pl merged_samples.bed &gt; tmp_file
$ awk –F “\t” ‘{print $3}’ tmp_file | sort | uniq –c | awk ‘{if ($1&gt;=2) print $2}’ &gt; recurrent_in_two_or_more_samples
$ fgrep –w –v –f recurrent_in_two_or_more_samples tmp_file | awk ‘{print $1}’ &gt; final_non_recurrent_list
</pre></div>
</div>
</div>
<div class="section" id="visualizing-output-in-circos-plots">
<h1>Visualizing output in Circos plots<a class="headerlink" href="#visualizing-output-in-circos-plots" title="Permalink to this headline">¶</a></h1>
<p>Circos representation (circos.ca) is a common way to visualize structural variations detected in a genome. Here we provide the configuration files necessary for generating a Circos plot similar to the one illustrated with your data.</p>
<p>Fig_circos_AAS</p>
<p>To install Circos see <a class="reference external" href="http://circos.ca/software/download/circos">http://circos.ca/software/download/circos</a>
fileX.conf</p>
<p>Circos plot command:</p>
<div class="highlight-python"><div class="highlight"><pre>$ circos –conf conf.conf
</pre></div>
</div>
</div>
<div class="section" id="updates">
<h1>Updates<a class="headerlink" href="#updates" title="Permalink to this headline">¶</a></h1>
<p>We intend to release updates for our recurrent artifact list as we analyze more mate-pair WGS samples (both tumor and normal).</p>
<p>We also encourage users to submit new recurrent artifacts with the appropriate read support to improve this resource. Get in touch with our group through email.</p>
</div>
<div class="section" id="data-access">
<h1>Data Access<a class="headerlink" href="#data-access" title="Permalink to this headline">¶</a></h1>
<p>The WGS data for samples used in our analyses were deposited in the European Nucleotide Archive (ENA; <a class="reference external" href="http://www.ebi.ac.uk/ena">http://www.ebi.ac.uk/ena</a>) under accession number PRJEB4781.</p>
<p>WGS data from the 1000 Genomes project was accessed through the Open Science Data Cloud (<a class="reference external" href="http://www.opensciencedatacloud.org">http://www.opensciencedatacloud.org</a>).</p>
</div>
<div class="section" id="acknowledgements">
<h1>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this headline">¶</a></h1>
<p>?</p>
</div>
<div class="section" id="authors">
<h1>Authors<a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h1>
<p>Elisa Donnard</p>
<p>Pedro Galante</p>
</div>
<div class="section" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<p>Paper ICRmax</p>
<p>Paper Biomarcadores</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ICRmax</a></li>
<li><a class="reference internal" href="#what-is-icrmax">What is ICRmax?</a></li>
<li><a class="reference internal" href="#how-icrmax-works">How ICRmax works</a></li>
<li><a class="reference internal" href="#benefits">Benefits</a></li>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#preparing-the-wgs-reads">Preparing the WGS reads</a></li>
<li><a class="reference internal" href="#step-by-step-command-line">Step-by-step command line</a></li>
<li><a class="reference internal" href="#step-by-step-here-arq-suplementar-icrmax">Step-by-step here (arq. Suplementar ICRmax)</a></li>
<li><a class="reference internal" href="#initial-icrmax-output">Initial ICRmax output</a></li>
<li><a class="reference internal" href="#removing-recurrent-events">Removing recurrent events</a></li>
<li><a class="reference internal" href="#detecting-new-recurrent-events-in-your-samples">Detecting new recurrent events in your samples</a></li>
<li><a class="reference internal" href="#visualizing-output-in-circos-plots">Visualizing output in Circos plots</a></li>
<li><a class="reference internal" href="#updates">Updates</a></li>
<li><a class="reference internal" href="#data-access">Data Access</a></li>
<li><a class="reference internal" href="#acknowledgements">Acknowledgements</a></li>
<li><a class="reference internal" href="#authors">Authors</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="#">ICRMax 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, BioInfo MOCHSL.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3a0.
    </div>
  </body>
</html>